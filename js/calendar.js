export function drawSixMonthCalendarGrid(container,opts){const{restricted,totalRooms,onPickRange}=opts;container.innerHTML='';const today=new Date();let startISO=null,endISO=null;const localISO=d=>`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;const mk=(y,m,d)=>new Date(y,m,d,0,0,0,0);const inRange=(d,a,b)=>d>=a&&d<=b;const parseISO=s=>{const[Y,M,D]=s.split('-').map(Number);return new Date(Y,(M-1),D,0,0,0,0)};const tagFor=day=>{const diwali=inRange(day,parseISO(restricted.diwali[0]),parseISO(restricted.diwali[1]));const xmas=inRange(day,parseISO(restricted.christmas[0]),parseISO(restricted.christmas[1]));const mon=inRange(day,parseISO(restricted.monsoon[0]),parseISO(restricted.monsoon[1]));if(mon)return{label:'Closed',cls:'closed',free:0};if(diwali||xmas)return{label:'Special',cls:'special',free:totalRooms};return{label:'Regular',cls:'season',free:totalRooms}};const dayClass=dISO=>{if(!startISO)return'';if(startISO&&!endISO&&dISO===startISO)return' selected';if(startISO&&endISO){if(dISO===startISO||dISO===endISO)return' selected';if(dISO>startISO&&dISO<endISO)return' in-range'}return''};function clickDay(dISO){if(!startISO){startISO=dISO;endISO=null;paint();return}if(dISO<startISO){startISO=dISO;endISO=null;paint();return}endISO=dISO;paint();if(typeof onPickRange==='function'){onPickRange(startISO,endISO)}}function monthGrid(add){const dt=new Date(today.getFullYear(),today.getMonth()+add,1);const wrap=document.createElement('div');wrap.className='card';wrap.innerHTML=`<h3>${dt.toLocaleString('en',{month:'long'})} ${dt.getFullYear()}</h3>`;const grid=document.createElement('div');grid.className='calendar';const head=document.createElement('div');head.className='cal-head';head.style.gridColumn='1 / span 7';const row=document.createElement('div');row.style.display='grid';row.style.gridTemplateColumns='repeat(7,1fr)';['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(w=>{const c=document.createElement('div');c.textContent=w;row.appendChild(c)});head.appendChild(row);grid.appendChild(head);const startDay=mk(dt.getFullYear(),dt.getMonth(),1).getDay();const daysInMonth=new Date(dt.getFullYear(),dt.getMonth()+1,0).getDate();for(let i=0;i<startDay;i++){const e=document.createElement('div');e.className='day disabled';grid.appendChild(e)}for(let d=1;d<=daysInMonth;d++){const day=mk(dt.getFullYear(),dt.getMonth(),d);const dISO=localISO(day);const meta=tagFor(day);const cell=document.createElement('div');cell.className='day'+dayClass(dISO);cell.innerHTML=`<div style="font-weight:600">${d}</div><div class="tag ${meta.cls}">${meta.label}</div><div class="badge">Free: ${meta.free}</div>`;if(meta.cls!=='closed'){cell.style.cursor='pointer';cell.addEventListener('click',()=>clickDay(dISO))}else cell.classList.add('disabled');grid.appendChild(cell)}wrap.appendChild(grid);return wrap}function paint(){container.innerHTML='';for(let add=0;add<6;add++){container.appendChild(monthGrid(add))}}paint()}