export class Assistant{constructor(o,m,i,s){this.out=document.getElementById(o);this.input=document.getElementById(i);this.sendBtn=document.getElementById(s);this.micBtn=document.getElementById(m);this.state={};this.say('Welcome! You can pick dates on the calendar, use the wizard, or just tell me what you want.');if(this.sendBtn)this.sendBtn.onclick=()=>this.onUser(this.input.value);if(this.input)this.input.onkeydown=e=>{if(e.key==='Enter')this.onUser(this.input.value)};if(this.micBtn)this.micBtn.onclick=()=>this.listen()}card(h){const d=document.createElement('div');d.className='card';d.innerHTML=h;this.out.appendChild(d);this.out.scrollTop=this.out.scrollHeight}say(t){this.card('<strong>Assistant:</strong> '+t);try{const u=new SpeechSynthesisUtterance(t);speechSynthesis.speak(u)}catch(e){}}listen(){try{const SR=window.SpeechRecognition||window.webkitSpeechRecognition;if(!SR){this.say('Voice input not supported here, please type.');return}const rec=new SR();rec.lang='en-IN';rec.interimResults=false;this.say('Listening...');rec.onresult=e=>this.onUser(e.results[0][0].transcript);rec.onerror=()=>this.say("Sorry, I couldn't hear that.");rec.start()}catch{this.say('Voice input not available.')}}onUser(t){if(!t)return;this.card('<strong>You:</strong> '+t);this.input.value='';if(/cart|pay/i.test(t)){this.say('After assigning occupants, click Add to Cart and then Proceed to Pay.');return}this.say('I’ll keep your selection updated here. In this test, please click to select.')}setState(s){this.state={...this.state,...s};const nights=this.state.nights||0;const rooms=(this.state.selectedRooms||[]).join(', ')||'none yet';const people=this.state.peopleSummary||'';const food=this.state.food||'(not set)';const msg=`Dates: ${this.state.range||'—'} • Nights: ${nights} • Rooms: ${rooms} • ${people} • Food: ${food}`;this.card('<em>'+msg+'</em>')}}